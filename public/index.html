<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‚ù§Ô∏è Like Duel - Telegram Duel O'yini</title>

    <!-- CDN kutubxonalari -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Mahalliy fayllar -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
      

        <!-- TELEGRAM NAVIGATION TABS -->
        <div class="nav-tabs">
            <div class="nav-tab active" data-tab="duel">
                <i class="fas fa-gamepad"></i> Duel
                <div class="nav-tab-indicator"></div>
            </div>
            <div class="nav-tab" data-tab="profile">
                <i class="fas fa-user"></i> Profil
                <div class="nav-tab-indicator"></div>
            </div>
            <div class="nav-tab" data-tab="friends">
                <i class="fas fa-users"></i> Do'stlar
                <div class="nav-tab-indicator"></div>
            </div>
            <div class="nav-tab" data-tab="shop">
                <i class="fas fa-shopping-cart"></i> Do'kon
                <div class="nav-tab-indicator"></div>
            </div>
            <div class="nav-tab" data-tab="leaderboard">
                <i class="fas fa-trophy"></i> Liderlar
                <div class="nav-tab-indicator"></div>
            </div>
        </div>

        <!-- DUEL TAB -->
        <div class="tab-content active" id="duelTab">
            <!-- WELCOME SCREEN -->
            <div class="duel-container" id="welcomeScreen">
               
                <div class="profile-card" id="profileCard">
                    <img src="" alt="Siz" class="profile-avatar" id="myAvatar">
                    <div class="profile-name" id="myName">Foydalanuvchi</div>
                    <div class="profile-username" id="myUsername">@username</div>

                    <div class="stats" style="display: flex; justify-content: space-around; margin: 20px 0;">
                        <div class="stat">
                            <div class="stat-value" id="myMatches">0</div>
                            <div class="stat-label">Matchlar</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="mutualMatchesCount">0</div>
                            <div class="stat-label">O'zaro Match</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="myLikes">0</div>
                            <div class="stat-label">Likelar</div>
                        </div>
                    </div>

                    <!-- Gender Filter Container avtomatik to'ldiriladi -->

                    <button class="start-btn" id="startBtn">
                        üéÆ O'yinni Boshlash
                    </button>
                </div>
            </div>

            <!-- QUEUE SCREEN -->
            <div class="duel-container hidden" id="queueScreen">
                <div class="loader"></div>
                <div class="waiting-info" style="font-size: 1.2rem; margin-bottom: 15px;">Navbat kutish...</div>
                <div class="waiting-count" id="waitingCount">0</div>
                <div class="position-info" id="positionInfo">
                    Sizning o'rningiz: <span id="position">-</span>
                </div>
                <div class="status-message" id="queueStatus">
                    Serverga ulanmoqda...
                </div>

                <div class="gender-warning hidden" id="genderWarning">
                    <div class="gender-warning-content">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <div style="font-weight: bold; font-size: 1.1rem;">Gender tanlanmagan!</div>
                            <div>Duel qilish uchun gender tanlashingiz kerak</div>
                        </div>
                    </div>
                    <button id="selectGenderNowBtn">
                        <i class="fas fa-user-edit"></i> Hozir tanlash
                    </button>
                </div>

                <button class="start-btn" id="leaveQueueBtn" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%); margin-top: 20px;">
                    üö™ Navbatdan Chiqish
                </button>
            </div>

            <!-- DUEL SCREEN -->
            <div class="duel-container hidden" id="duelScreen">
                <img src="" alt="Raqib" class="opponent-avatar" id="opponentAvatar">
                <div class="opponent-info">
                    <div class="opponent-name" id="opponentName">Raqib</div>
                    <div class="opponent-username" id="opponentUsername">@username</div>

                    <div class="opponent-stats">
                        <span><i class="fas fa-trophy"></i> <span id="opponentRating">1500</span></span>
                        <span><i class="fas fa-heart"></i> <span id="opponentMatches">0</span></span>
                        <span><i class="fas fa-level-up-alt"></i> <span id="opponentLevel">1</span></span>
                    </div>
                </div>

                <div class="super-like-indicator" id="superLikeIndicator">
                    <i class="fas fa-gem"></i>
                    Kunlik SUPER LIKE: <span id="superLikeCount">3</span> ta qoldi
                </div>

                <div class="timer-container">
                    <div class="timer-circle">
                        <div class="timer" id="timer">20</div>
                    </div>
                </div>

                <div class="vote-container">
                    <div class="vote-buttons" id="voteButtons">
                        <div class="vote-btn-group">
                            <button class="vote-btn btn-no" id="noBtn">‚úñ</button>
                            <div class="vote-label">O'tkazish</div>
                        </div>
                        <div class="vote-btn-group">
                            <button class="vote-btn btn-like" id="likeBtn">‚ù§Ô∏è</button>
                            <div class="vote-label">Like</div>
                        </div>
                        <div class="vote-btn-group">
                            <button class="vote-btn btn-super-like" id="superLikeBtn">üíñ</button>
                            <div class="vote-label">Super Like</div>
                        </div>
                    </div>
                </div>

                <div class="status-message" id="duelStatus">
                    Ovoz bering: ‚ù§Ô∏è yoki üíñ yoki ‚úñ
                </div>
            </div>

            <!-- MATCH SCREEN -->
             <!-- Match screen qo'shimchalari -->
<div class="match-screen hidden" id="matchScreen">
    <div class="match-title">üéâ MATCH!</div>
    <div class="match-text" id="matchText">
        <span id="partnerName">Foydalanuvchi</span> bilan match!
    </div>

    <div class="rewards" id="matchRewards">
        <div style="display: flex; justify-content: center; gap: 20px;">
            <div><i class="fas fa-coins"></i> +<span id="rewardCoins">50</span></div>
            <div><i class="fas fa-star"></i> +<span id="rewardXP">30</span> XP</div>
            <div><i class="fas fa-users"></i> <span style="color: #fff;">DO'ST BO'LDINGIZ!</span></div>
        </div>
    </div>

    <div class="match-options" id="matchOptions">
        <!-- Tugmalar JavaScript orqali yaratiladi -->
    </div>
</div>

<!-- Modal overlay -->
<div class="modal-overlay" id="modalOverlay" onclick="closeChatModal()"></div>
            <div class="match-screen hidden" id="matchScreen">
                <div class="match-title">üéâ MATCH!</div>
                <div class="match-text" id="matchText">
                    <span id="partnerName">Foydalanuvchi</span> bilan match!
                </div>

                <div class="rewards" id="matchRewards">
                    <div style="display: flex; justify-content: center; gap: 20px;">
                        <div><i class="fas fa-coins"></i> +<span id="rewardCoins">50</span></div>
                        <div><i class="fas fa-star"></i> +<span id="rewardXP">30</span> XP</div>
                        <div><i class="fas fa-users"></i> <span style="color: #fff;">DO'ST BO'LDINGIZ!</span></div>
                    </div>
                </div>

                <div class="match-options" id="matchOptions"></div>
            </div>
        </div>

        <!-- PROFILE TAB -->
        <div class="tab-content" id="profileTab">
            <div class="profile-container">
                <div class="profile-header">
                    <img src="" alt="Siz" class="profile-avatar" id="profileAvatar">
                    <div class="profile-info">
                        <h2 id="profileName">Foydalanuvchi</h2>
                        <p id="profileUsername">@username</p>
                        <p id="profileBio" style="font-size: 0.9rem; margin-top: 5px;">Bio kiritilmagan</p>
                    </div>
                </div>

                <div class="profile-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="statRating">1500</div>
                        <div class="stat-label">Reyting</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statMatches">0</div>
                        <div class="stat-label">Matchlar</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statDuels">0</div>
                        <div class="stat-label">Duellar</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="mutualMatchesProfile">0</div>
                        <div class="stat-label">O'zaro Match</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statWinRate">0%</div>
                        <div class="stat-label">G'alaba %</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statFriends">0</div>
                        <div class="stat-label">Do'stlar</div>
                    </div>
                </div>

                <div class="profile-actions">
                    <button class="match-option-btn" id="editProfileBtn" style="margin-bottom: 10px;">
                        <i class="fas fa-edit"></i> Profilni Tahrirlash
                    </button>
                    <button class="match-option-btn" id="viewStatsBtn" style="background: #3498db;">
                        <i class="fas fa-chart-bar"></i> Batafsil Statistika
                    </button>
                </div>
            </div>

            <div class="quests-container">
                <h3><i class="fas fa-tasks"></i> Kunlik Vazifalar</h3>
                <div id="profileQuestsList"></div>
            </div>
        </div>

        <!-- FRIENDS TAB -->
        <div class="tab-content" id="friendsTab">
            <div class="friends-container">
                <div id="friendsStatus">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div>
                            <div style="font-weight: bold; font-size: 1.1rem;">Do'stlar Ro'yxati</div>
                            <div style="font-size: 0.8rem; opacity: 0.8;">
                                <span id="friendsCount">0</span> ta do'st ‚Ä¢
                                <span id="onlineFriendsCount">0</span> ta onlayn
                            </div>
                        </div>
                        <button class="refresh-btn" id="refreshFriendsBtn">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>

                <div class="friend-list" id="friendsList"></div>
                
                <div class="no-friends hidden" id="noFriends">
                    <div style="font-size: 3rem; margin-bottom: 15px;">üòî</div>
                    <div style="font-weight: bold; margin-bottom: 10px;">Hali do'stlaringiz yo'q</div>
                    <div style="opacity: 0.7; margin-bottom: 20px;">O'zaro like bergan foydalanuvchilar bu yerda ko'rinadi</div>
                    <button class="start-btn" onclick="gameState.currentTab = 'duel'; showScreen('welcome');">
                        üéÆ Duel O'ynash
                    </button>
                </div>
            </div>
        </div>

        <!-- SHOP TAB -->
        <div class="tab-content" id="shopTab">
            <div class="shop-container">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3><i class="fas fa-shopping-cart"></i> Do'kon</h3>
                    <div class="stat-item" style="font-size: 1.1rem;">
                        <i class="fas fa-coins"></i>
                        <span id="shopCoinsCount">100</span>
                    </div>
                </div>

                <div class="shop-items" id="shopItemsList"></div>
            </div>
        </div>

        <!-- LEADERBOARD TAB -->
        <div class="tab-content" id="leaderboardTab">
            <div class="leaderboard-container">
                <h3><i class="fas fa-trophy"></i> Liderlar Doskasi</h3>

                <div class="leaderboard-tabs">
                    <div class="leaderboard-tab active" data-leaderboard="rating">Reyting</div>
                    <div class="leaderboard-tab" data-leaderboard="matches">Matchlar</div>
                    <div class="leaderboard-tab" data-leaderboard="friends">Do'stlar</div>
                </div>

                <div class="leaderboard-list" id="leaderboardList"></div>

                <div class="leaderboard-updated">
                    Yangilangan: <span id="leaderboardUpdated">hozir</span>
                </div>
            </div>
        </div>
    </div>

    <!-- MODALLAR -->
    <!-- Gender tanlash (majburiy) -->
    <div class="gender-modal mandatory-modal" id="genderModal">
        <div class="modal-content">
            <div style="font-size: 3rem; margin-bottom: 15px;">üë§</div>
            <h2 style="margin-bottom: 10px; color: #e74c3c;">‚ö†Ô∏è MAJBURIY: Jinsni Tanlang</h2>
            <p style="margin-bottom: 20px; opacity: 0.7; color: #e74c3c; font-weight: bold;">
                Gender tanlamasangiz duel o'ynay olmaysiz!
            </p>
            <p style="margin-bottom: 20px; opacity: 0.7;">
                Bu sizning duel qilish sozlamangiz. Keyinchalik profil orqali o'zgartirishingiz mumkin.
            </p>

            <div class="gender-options">
                <button class="gender-option-btn gender-male" id="selectMaleBtn">
                    <i class="fas fa-mars"></i>
                    <div style="text-align: left; flex: 1;">
                        <div style="font-weight: bold;">Erkak</div>
                        <div style="font-size: 0.8rem; opacity: 0.9;">Faqat ayollar bilan duel</div>
                    </div>
                </button>

                <button class="gender-option-btn gender-female" id="selectFemaleBtn">
                    <i class="fas fa-venus"></i>
                    <div style="text-align: left; flex: 1;">
                        <div style="font-weight: bold;">Ayol</div>
                        <div style="font-size: 0.8rem; opacity: 0.9;">Faqat erkaklar bilan duel</div>
                    </div>
                </button>

                <button class="gender-option-btn gender-all" id="selectAllBtn">
                    <i class="fas fa-users"></i>
                    <div style="text-align: left; flex: 1;">
                        <div style="font-weight: bold;">Hammasi</div>
                        <div style="font-size: 0.8rem; opacity: 0.9;">Har qanday jins bilan duel</div>
                    </div>
                </button>
            </div>

            <div style="margin-top: 20px; padding: 10px; background: #f8f9fa; border-radius: 10px;">
                <p style="font-size: 0.8rem; opacity: 0.7; margin: 0;">
                    <i class="fas fa-info-circle"></i> Eslatma: Gender tanlaganingizdan keyin o'zgartirishingiz mumkin,
                    lekin duel qilish uchun gender tanlash MAJBURIY!
                </p>
            </div>
        </div>
    </div>

    <!-- Profil tahrirlash -->
    <div class="chat-modal" id="profileEditModal">
        <div class="chat-box">
            <div class="chat-header">
                <div>Profilni Tahrirlash</div>
                <button id="closeProfileEditBtn"><i class="fas fa-times"></i></button>
            </div>
            <div class="chat-messages" style="height: auto; padding: 20px;">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Bio</label>
                    <textarea id="editBio" placeholder="O'zingiz haqingizda yozing..." rows="4"></textarea>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Jins</label>
                    <select id="editGender">
                        <option value="not_specified">Ko'rsatilmaydi (hamma bilan)</option>
                        <option value="male">Erkak (faqat ayollar bilan)</option>
                        <option value="female">Ayol (faqat erkaklar bilan)</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Filter</label>
                    <select id="editFilter">
                        <option value="not_specified">Hamma bilan duel</option>
                        <option value="male">Faqat erkaklar bilan</option>
                        <option value="female">Faqat ayollar bilan</option>
                    </select>
                </div>
                <button id="saveProfileBtn">Saqlash</button>
            </div>
        </div>
    </div>

    <!-- Chat modal -->
    <div class="chat-modal" id="chatModal">
        <div class="modal-overlay" onclick="closeChatModal()"></div>
        <div class="chat-box">
            <div class="chat-header">
                <div id="chatTitle">Chat</div>
                <button id="closeChatBtn"><i class="fas fa-times"></i></button>
            </div>
            <div class="chat-content">
                <img src="" alt="" class="chat-avatar" id="chatPartnerAvatar">
                <div class="chat-name" id="chatPartnerName">Foydalanuvchi</div>
                <div class="chat-username" id="chatUsername">@username</div>
                
                <button class="chat-button" id="chatOpenTelegramBtn">
                    <i class="fab fa-telegram"></i> Telegramda ochish
                </button>
                
                <button class="chat-button secondary" onclick="closeChatModal(); skipToNextDuel();">
                    <i class="fas fa-play"></i> Duelni davom ettirish
                </button>
                
                <div class="chat-note">
                    <p><i class="fas fa-info-circle"></i> Match bo'lganingiz uchun endi bir-biringiz bilan bemalol suhbatlashingiz mumkin!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-content">
            <div id="notificationTitle" style="font-weight: bold; margin-bottom: 5px;"></div>
            <div id="notificationMessage"></div>
        </div>
    </div>

    <script src="main.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
    window.Telegram.WebApp.ready();
    window.Telegram.WebApp.expand(); // To'liq ekran
</script>
</body>
</html>